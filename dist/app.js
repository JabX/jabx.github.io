(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var React = require('react/addons');
var Reflux = require('reflux');
var Swipe = require('react-swipe');

var TopBar = require('./top-bar.jsx');
var SlidePage = require('./slide-page.jsx');
var ChatPage = require('./chat-page.jsx');

var Slides = require('./slides');

var App = React.createClass({displayName: "App",
    mixins: [Reflux.connect(Slides.Store, "slides")],

    getInitialState: function() {
        return {
            slides: Slides.Store.slides,
            currentSlide: 1
        };
    },

    changeSlide: function(slide) {
        this.setState({ currentSlide: slide });
    },

    toChat: function() {
        this.refs.carousel.next();
    },

    toSlide: function() {
        this.refs.carousel.prev();
    },

    render: function() {
        return (
            React.createElement("div", {className: "app"}, 
                React.createElement(TopBar, {currentSlide: this.state.currentSlide, onClick: this.changeSlide}), 
                React.createElement(Swipe, {ref: "carousel", className: "main", edgeFlick: false}, 
                    React.createElement(SlidePage, {slides: this.state.slides, currentSlide: this.state.currentSlide, toChat: this.toChat}), 
                    React.createElement(ChatPage, {slides: this.state.slides, currentSlide: this.state.currentSlide, toSlide: this.toSlide})
                )
            )
        );
    }
});

React.render(React.createElement(App, null), document.body);

},{"./chat-page.jsx":2,"./slide-page.jsx":3,"./slides":4,"./top-bar.jsx":5,"react-swipe":"react-swipe","react/addons":"react/addons","reflux":"reflux"}],2:[function(require,module,exports){
var React = require('react/addons');
var TransitionGroup = React.addons.CSSTransitionGroup;

var Slides = require('./slides');

var Message = React.createClass({displayName: "Message",
    mixins:[React.addons.PureRenderMixin],

    render: function() {
        var sender = this.props.message.sender;
        var date = this.props.message.time.toLocaleString('en-US');
        var content = this.props.message.content;
        return (
            React.createElement("div", {className: "message"}, 
                React.createElement("h4", null, sender, " at ", date), 
                React.createElement("p", null, content)
            )
        );
    }
});

module.exports = React.createClass({displayName: "exports",
    getInitialState: function() {
        return {
            slideTransition: "slideLeft",
            newMessage: ""
        }
    },

    componentWillReceiveProps: function(nextProps) {
        if(nextProps.currentSlide > this.props.currentSlide)
            this.setState({slideTransition: "slideLeft"});
        else
            this.setState({slideTransition: "slideRight"});
    },

    handleMessage: function(e) {
        this.setState({newMessage: e.target.value});
    },

    sendMessage: function() {
        Slides.Actions.PostMessage(this.props.currentSlide - 1, this.state.newMessage);
        this.setState({newMessage: ""});
    },

    render: function() {
        var currentSlide = this.props.currentSlide - 1;
        var slides = this.props.slides;
        var slide = slides[currentSlide];

        var messages;
        if (slide.messages.length > 0)
            messages = slide.messages.map(function(message, i) {
                return React.createElement(Message, {key: i, message: message});
            });
        else
            messages = React.createElement("div", {style: {margin: "20px"}}, "No messages yet on this slide")

        return (
            React.createElement("div", {className: "chat-page", style: this.props.style}, 
                React.createElement(TransitionGroup, {className: "message-container", component: "div", transitionName: this.state.slideTransition}, 
                    React.createElement(TransitionGroup, {key: currentSlide, transitionName: "messageAppear", component: "div", style: {height: 'calc(100% - 10px)'}, transitionLeave: false}, 
                        messages
                    )
                ), 
                React.createElement("button", {className: "button-to-slide", onClick: this.props.toSlide}, React.createElement("img", {src: "img/slideButton.svg"})), 
                React.createElement("textarea", {value: this.state.newMessage, onChange: this.handleMessage}), 
                React.createElement("button", {onClick: this.sendMessage}, "Send")
            )
        );
    }
});

},{"./slides":4,"react/addons":"react/addons"}],3:[function(require,module,exports){
var React = require('react/addons');
var TransitionGroup = React.addons.CSSTransitionGroup;

module.exports = React.createClass({displayName: "exports",
    mixins:[React.addons.PureRenderMixin],

    getInitialState: function() {
        return {
            slideTransition: "slideLeft"
        }
    },

    componentWillReceiveProps: function(nextProps) {
        if(nextProps.currentSlide > this.props.currentSlide)
            this.setState({slideTransition: "slideLeft"});
        else
            this.setState({slideTransition: "slideRight"});
    },

    render: function() {
        var currentSlide = this.props.currentSlide - 1;
        var slides = this.props.slides;
        var slide = slides[currentSlide];

        return (
            React.createElement(TransitionGroup, {style: this.props.style, className: "slide-container", component: "div", transitionName: this.state.slideTransition}, 
                React.createElement("div", {key: currentSlide, className: "slide"}, 
                    React.createElement("h2", null, slide.title), 
                    React.createElement("img", {src: slide.picture}), 
                    slide.text.map(function(point, i) {
                        if(point[0] == " ")
                            return React.createElement("h4", {key: i}, "- ", point);
                        else
                            return React.createElement("h3", {key: i}, "- ", point);
                    })
                ), 
                React.createElement("button", {className: "button-to-chat", onClick: this.props.toChat}, React.createElement("img", {src: "img/chatButton.svg"}))
            )
        )
    }
});

},{"react/addons":"react/addons"}],4:[function(require,module,exports){
var Reflux = require('reflux');

var Actions = Reflux.createActions([
    'PostMessage'
]);

var Store = Reflux.createStore({
    listenables: [Actions],

    slides: [
        {
            title: "First Slide",
            picture: "img/slide1.jpg",
            text: [
                "Bullet Point 1",
                "Bullet Point 2",
                "   Bullet Point 2.1",
                "   Bullet Point 2.2",
                "Bullet Point 3"
            ],
            messages: [
                {
                    sender: "John Smith",
                    time: new Date(2015, 2, 2, 8, 23, 0, 0),
                    content: "Hello guys, anything to say on the first slide?"
                },
                {
                    sender: "Jane Porter",
                    time: new Date(2015, 2, 2, 8, 31, 0, 0),
                    content: "Well indeed, I'm not sure I got what the presenter said about point 2.2, can you help me?"
                }
            ]
        },
        {
            title: "Second Slide",
            picture: "img/slide2.jpg",
            text: [
                "Bullet Point 1",
                "Bullet Point 2",
                "   Bullet Point 2.1",
                "   Bullet Point 2.2",
                "Bullet Point 3",
                "   Bullet Point 3.1",
                "   Bullet Point 3.2",
                "   Bullet Point 3.3",
                "   Bullet Point 3.4",
                "Bullet Point 4",
                "Bullet Point 5",
                "Bullet Point 6",
                "   Bullet Point 6.1"
            ],
            messages: [
                {
                    sender: "Jane Porter",
                    time: new Date(2015, 2, 2, 8, 43, 0, 0),
                    content: "Wow, this slide is just horrible, there's too much information on it I can't figure out what I should really remember on that"
                },
                {
                    sender: "Chris Jack",
                    time: new Date(2015, 2, 2, 8, 46, 0, 0),
                    content: "I feel your pain, but from what I got I feel like everything is important on there"
                },
                {
                    sender: "John Smith",
                    time: new Date(2015, 2, 2, 9, 11, 0, 0),
                    content: "Oh really, the most important point is the second one, the rest is just detail. I agree the presenter should have made it clearer though."
                }
            ]
        },
        {
            title: "Third Slide",
            picture: "img/slide3.jpg",
            text: [
                "Bullet Point 1",
                "   Bullet Point 1.1",
                "   Bullet Point 1.2",
                "   Bullet Point 1.3",
                "Bullet Point 2",
                "   Bullet Point 2.1"
            ],
            messages: [

            ]
        }
    ],

    onPostMessage: function(slideId, message) {
        if(message != "") {
            this.slides[slideId].messages = this.slides[slideId].messages.concat({
                sender: "Me",
                time: new Date(Date.now()),
                content: message
            });

            this.trigger(this.slides);
        }
    }
});

module.exports = {Actions: Actions, Store: Store};


},{"reflux":"reflux"}],5:[function(require,module,exports){
var React = require('react/addons');

module.exports = React.createClass({displayName: "exports",
    getDefaultProps: function() {
        return {
            currentSlide: 1
        };
    },

    render: function() {
        var id = this.props.currentSlide;
        return (
          React.createElement("div", {className: "top-bar"}, 
              React.createElement("button", {className: "button-first", onClick: this.props.onClick.bind(null, 1)}, "1"), 
              React.createElement("button", {className: "button-back", onClick: this.props.onClick.bind(null, Math.max(1, id - 1))}), 
              React.createElement("button", {className: "button-middle"}, this.props.currentSlide), 
              React.createElement("button", {className: "button-next", onClick: this.props.onClick.bind(null, Math.min(3, id + 1))}), 
              React.createElement("button", {className: "button-last", onClick: this.props.onClick.bind(null, 3)}, "3")
          )
        );
    }
});

},{"react/addons":"react/addons"}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwiRDpcXG9uZWRyaXZlXFxDb3Vyc1xcSUhNXFxBcHBcXGFwcFxcYXBwLmpzeCIsIkQ6XFxvbmVkcml2ZVxcQ291cnNcXElITVxcQXBwXFxhcHBcXGNoYXQtcGFnZS5qc3giLCJEOlxcb25lZHJpdmVcXENvdXJzXFxJSE1cXEFwcFxcYXBwXFxzbGlkZS1wYWdlLmpzeCIsIkQ6XFxvbmVkcml2ZVxcQ291cnNcXElITVxcQXBwXFxhcHBcXHNsaWRlcy5qcyIsIkQ6XFxvbmVkcml2ZVxcQ291cnNcXElITVxcQXBwXFxhcHBcXHRvcC1iYXIuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQ3BDLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUMvQixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7O0FBRW5DLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUN0QyxJQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUM1QyxJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQzs7QUFFMUMsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDOztBQUVqQyxJQUFJLHlCQUF5QixtQkFBQTtBQUM3QixJQUFJLE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQzs7SUFFaEQsZUFBZSxFQUFFLFdBQVc7UUFDeEIsT0FBTztZQUNILE1BQU0sRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU07WUFDM0IsWUFBWSxFQUFFLENBQUM7U0FD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LElBQUksRUFBRSxDQUFDLENBQUcsQ0FBQSxFQUFBLEdBQVUsQ0FBQSxFQUFBO2NBQ3RGLG9CQUFBLFFBQU8sRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsYUFBQSxFQUFhLENBQUMsT0FBQSxFQUFPLENBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUUsQ0FBQSxDQUFHLENBQUEsRUFBQTtjQUMvRixvQkFBQSxRQUFPLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGVBQWdCLENBQUEsRUFBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQXNCLENBQUEsRUFBQTtjQUNwRSxvQkFBQSxRQUFPLEVBQUEsQ0FBQSxDQUFDLFNBQUEsRUFBUyxDQUFDLGFBQUEsRUFBYSxDQUFDLE9BQUEsRUFBTyxDQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFFLENBQUUsQ0FBQSxFQUFBO2NBQzlGLG9CQUFBLFFBQU8sRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsYUFBQSxFQUFhLENBQUMsT0FBQSxFQUFPLENBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUcsQ0FBQSxFQUFBLEdBQVUsQ0FBQTtVQUNuRixDQUFBO1VBQ047S0FDTDtDQUNKLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIFJlYWN0ID0gcmVxdWlyZSgncmVhY3QvYWRkb25zJyk7XHJcbnZhciBSZWZsdXggPSByZXF1aXJlKCdyZWZsdXgnKTtcclxudmFyIFN3aXBlID0gcmVxdWlyZSgncmVhY3Qtc3dpcGUnKTtcclxuXHJcbnZhciBUb3BCYXIgPSByZXF1aXJlKCcuL3RvcC1iYXIuanN4Jyk7XHJcbnZhciBTbGlkZVBhZ2UgPSByZXF1aXJlKCcuL3NsaWRlLXBhZ2UuanN4Jyk7XHJcbnZhciBDaGF0UGFnZSA9IHJlcXVpcmUoJy4vY2hhdC1wYWdlLmpzeCcpO1xyXG5cclxudmFyIFNsaWRlcyA9IHJlcXVpcmUoJy4vc2xpZGVzJyk7XHJcblxyXG52YXIgQXBwID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xyXG4gICAgbWl4aW5zOiBbUmVmbHV4LmNvbm5lY3QoU2xpZGVzLlN0b3JlLCBcInNsaWRlc1wiKV0sXHJcblxyXG4gICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzbGlkZXM6IFNsaWRlcy5TdG9yZS5zbGlkZXMsXHJcbiAgICAgICAgICAgIGN1cnJlbnRTbGlkZTogMVxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIGNoYW5nZVNsaWRlOiBmdW5jdGlvbihzbGlkZSkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50U2xpZGU6IHNsaWRlIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICB0b0NoYXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMucmVmcy5jYXJvdXNlbC5uZXh0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHRvU2xpZGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMucmVmcy5jYXJvdXNlbC5wcmV2KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhcHBcIj5cclxuICAgICAgICAgICAgICAgIDxUb3BCYXIgY3VycmVudFNsaWRlPXt0aGlzLnN0YXRlLmN1cnJlbnRTbGlkZX0gb25DbGljaz17dGhpcy5jaGFuZ2VTbGlkZX0gLz5cclxuICAgICAgICAgICAgICAgIDxTd2lwZSByZWY9XCJjYXJvdXNlbFwiIGNsYXNzTmFtZT1cIm1haW5cIiBlZGdlRmxpY2s9e2ZhbHNlfT5cclxuICAgICAgICAgICAgICAgICAgICA8U2xpZGVQYWdlIHNsaWRlcz17dGhpcy5zdGF0ZS5zbGlkZXN9IGN1cnJlbnRTbGlkZT17dGhpcy5zdGF0ZS5jdXJyZW50U2xpZGV9IHRvQ2hhdD17dGhpcy50b0NoYXR9IC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPENoYXRQYWdlIHNsaWRlcz17dGhpcy5zdGF0ZS5zbGlkZXN9IGN1cnJlbnRTbGlkZT17dGhpcy5zdGF0ZS5jdXJyZW50U2xpZGV9IHRvU2xpZGU9e3RoaXMudG9TbGlkZX0gLz5cclxuICAgICAgICAgICAgICAgIDwvU3dpcGU+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuUmVhY3QucmVuZGVyKDxBcHAgLz4sIGRvY3VtZW50LmJvZHkpOyIsInZhciBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0L2FkZG9ucycpO1xyXG52YXIgVHJhbnNpdGlvbkdyb3VwID0gUmVhY3QuYWRkb25zLkNTU1RyYW5zaXRpb25Hcm91cDtcclxuXHJcbnZhciBTbGlkZXMgPSByZXF1aXJlKCcuL3NsaWRlcycpO1xyXG5cclxudmFyIE1lc3NhZ2UgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XHJcbiAgICBtaXhpbnM6W1JlYWN0LmFkZG9ucy5QdXJlUmVuZGVyTWl4aW5dLFxyXG5cclxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbmRlciA9IHRoaXMucHJvcHMubWVzc2FnZS5zZW5kZXI7XHJcbiAgICAgICAgdmFyIGRhdGUgPSB0aGlzLnByb3BzLm1lc3NhZ2UudGltZS50b0xvY2FsZVN0cmluZygnZW4tVVMnKTtcclxuICAgICAgICB2YXIgY29udGVudCA9IHRoaXMucHJvcHMubWVzc2FnZS5jb250ZW50O1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWVzc2FnZVwiPlxyXG4gICAgICAgICAgICAgICAgPGg0PntzZW5kZXJ9IGF0IHtkYXRlfTwvaDQ+XHJcbiAgICAgICAgICAgICAgICA8cD57Y29udGVudH08L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XHJcbiAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNsaWRlVHJhbnNpdGlvbjogXCJzbGlkZUxlZnRcIixcclxuICAgICAgICAgICAgbmV3TWVzc2FnZTogXCJcIlxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24obmV4dFByb3BzKSB7XHJcbiAgICAgICAgaWYobmV4dFByb3BzLmN1cnJlbnRTbGlkZSA+IHRoaXMucHJvcHMuY3VycmVudFNsaWRlKVxyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtzbGlkZVRyYW5zaXRpb246IFwic2xpZGVMZWZ0XCJ9KTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe3NsaWRlVHJhbnNpdGlvbjogXCJzbGlkZVJpZ2h0XCJ9KTtcclxuICAgIH0sXHJcblxyXG4gICAgaGFuZGxlTWVzc2FnZTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe25ld01lc3NhZ2U6IGUudGFyZ2V0LnZhbHVlfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNlbmRNZXNzYWdlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBTbGlkZXMuQWN0aW9ucy5Qb3N0TWVzc2FnZSh0aGlzLnByb3BzLmN1cnJlbnRTbGlkZSAtIDEsIHRoaXMuc3RhdGUubmV3TWVzc2FnZSk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7bmV3TWVzc2FnZTogXCJcIn0pO1xyXG4gICAgfSxcclxuXHJcbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50U2xpZGUgPSB0aGlzLnByb3BzLmN1cnJlbnRTbGlkZSAtIDE7XHJcbiAgICAgICAgdmFyIHNsaWRlcyA9IHRoaXMucHJvcHMuc2xpZGVzO1xyXG4gICAgICAgIHZhciBzbGlkZSA9IHNsaWRlc1tjdXJyZW50U2xpZGVdO1xyXG5cclxuICAgICAgICB2YXIgbWVzc2FnZXM7XHJcbiAgICAgICAgaWYgKHNsaWRlLm1lc3NhZ2VzLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzID0gc2xpZGUubWVzc2FnZXMubWFwKGZ1bmN0aW9uKG1lc3NhZ2UsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiA8TWVzc2FnZSBrZXk9e2l9IG1lc3NhZ2U9e21lc3NhZ2V9IC8+O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzID0gPGRpdiBzdHlsZT17e21hcmdpbjogXCIyMHB4XCJ9fT5ObyBtZXNzYWdlcyB5ZXQgb24gdGhpcyBzbGlkZTwvZGl2PlxyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNoYXQtcGFnZVwiIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfT5cclxuICAgICAgICAgICAgICAgIDxUcmFuc2l0aW9uR3JvdXAgY2xhc3NOYW1lPVwibWVzc2FnZS1jb250YWluZXJcIiBjb21wb25lbnQ9XCJkaXZcIiB0cmFuc2l0aW9uTmFtZT17dGhpcy5zdGF0ZS5zbGlkZVRyYW5zaXRpb259PlxyXG4gICAgICAgICAgICAgICAgICAgIDxUcmFuc2l0aW9uR3JvdXAga2V5PXtjdXJyZW50U2xpZGV9IHRyYW5zaXRpb25OYW1lPVwibWVzc2FnZUFwcGVhclwiIGNvbXBvbmVudD1cImRpdlwiIHN0eWxlPXt7aGVpZ2h0OiAnY2FsYygxMDAlIC0gMTBweCknfX0gdHJhbnNpdGlvbkxlYXZlPXtmYWxzZX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHttZXNzYWdlc31cclxuICAgICAgICAgICAgICAgICAgICA8L1RyYW5zaXRpb25Hcm91cD5cclxuICAgICAgICAgICAgICAgIDwvVHJhbnNpdGlvbkdyb3VwPlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidXR0b24tdG8tc2xpZGVcIiBvbkNsaWNrPXt0aGlzLnByb3BzLnRvU2xpZGV9PjxpbWcgc3JjPVwiaW1nL3NsaWRlQnV0dG9uLnN2Z1wiIC8+PC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICA8dGV4dGFyZWEgdmFsdWU9e3RoaXMuc3RhdGUubmV3TWVzc2FnZX0gb25DaGFuZ2U9e3RoaXMuaGFuZGxlTWVzc2FnZX0gLz5cclxuICAgICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17dGhpcy5zZW5kTWVzc2FnZX0+U2VuZDwvYnV0dG9uPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59KTsiLCJ2YXIgUmVhY3QgPSByZXF1aXJlKCdyZWFjdC9hZGRvbnMnKTtcclxudmFyIFRyYW5zaXRpb25Hcm91cCA9IFJlYWN0LmFkZG9ucy5DU1NUcmFuc2l0aW9uR3JvdXA7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcclxuICAgIG1peGluczpbUmVhY3QuYWRkb25zLlB1cmVSZW5kZXJNaXhpbl0sXHJcblxyXG4gICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzbGlkZVRyYW5zaXRpb246IFwic2xpZGVMZWZ0XCJcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uKG5leHRQcm9wcykge1xyXG4gICAgICAgIGlmKG5leHRQcm9wcy5jdXJyZW50U2xpZGUgPiB0aGlzLnByb3BzLmN1cnJlbnRTbGlkZSlcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7c2xpZGVUcmFuc2l0aW9uOiBcInNsaWRlTGVmdFwifSk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtzbGlkZVRyYW5zaXRpb246IFwic2xpZGVSaWdodFwifSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRTbGlkZSA9IHRoaXMucHJvcHMuY3VycmVudFNsaWRlIC0gMTtcclxuICAgICAgICB2YXIgc2xpZGVzID0gdGhpcy5wcm9wcy5zbGlkZXM7XHJcbiAgICAgICAgdmFyIHNsaWRlID0gc2xpZGVzW2N1cnJlbnRTbGlkZV07XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxUcmFuc2l0aW9uR3JvdXAgc3R5bGU9e3RoaXMucHJvcHMuc3R5bGV9IGNsYXNzTmFtZT1cInNsaWRlLWNvbnRhaW5lclwiIGNvbXBvbmVudD1cImRpdlwiIHRyYW5zaXRpb25OYW1lPXt0aGlzLnN0YXRlLnNsaWRlVHJhbnNpdGlvbn0+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17Y3VycmVudFNsaWRlfSBjbGFzc05hbWU9XCJzbGlkZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxoMj57c2xpZGUudGl0bGV9PC9oMj5cclxuICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz17c2xpZGUucGljdHVyZX0gLz5cclxuICAgICAgICAgICAgICAgICAgICB7c2xpZGUudGV4dC5tYXAoZnVuY3Rpb24ocG9pbnQsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYocG9pbnRbMF0gPT0gXCIgXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGg0IGtleT17aX0+LSB7cG9pbnR9PC9oND47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiA8aDMga2V5PXtpfT4tIHtwb2ludH08L2gzPjtcclxuICAgICAgICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidXR0b24tdG8tY2hhdFwiIG9uQ2xpY2s9e3RoaXMucHJvcHMudG9DaGF0fT48aW1nIHNyYz1cImltZy9jaGF0QnV0dG9uLnN2Z1wiIC8+PC9idXR0b24+XHJcbiAgICAgICAgICAgIDwvVHJhbnNpdGlvbkdyb3VwPlxyXG4gICAgICAgIClcclxuICAgIH1cclxufSk7IiwidmFyIFJlZmx1eCA9IHJlcXVpcmUoJ3JlZmx1eCcpO1xyXG5cclxudmFyIEFjdGlvbnMgPSBSZWZsdXguY3JlYXRlQWN0aW9ucyhbXHJcbiAgICAnUG9zdE1lc3NhZ2UnXHJcbl0pO1xyXG5cclxudmFyIFN0b3JlID0gUmVmbHV4LmNyZWF0ZVN0b3JlKHtcclxuICAgIGxpc3RlbmFibGVzOiBbQWN0aW9uc10sXHJcblxyXG4gICAgc2xpZGVzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aXRsZTogXCJGaXJzdCBTbGlkZVwiLFxyXG4gICAgICAgICAgICBwaWN0dXJlOiBcImltZy9zbGlkZTEuanBnXCIsXHJcbiAgICAgICAgICAgIHRleHQ6IFtcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDFcIixcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDJcIixcclxuICAgICAgICAgICAgICAgIFwiICAgQnVsbGV0IFBvaW50IDIuMVwiLFxyXG4gICAgICAgICAgICAgICAgXCIgICBCdWxsZXQgUG9pbnQgMi4yXCIsXHJcbiAgICAgICAgICAgICAgICBcIkJ1bGxldCBQb2ludCAzXCJcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzZW5kZXI6IFwiSm9obiBTbWl0aFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKDIwMTUsIDIsIDIsIDgsIDIzLCAwLCAwKSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBcIkhlbGxvIGd1eXMsIGFueXRoaW5nIHRvIHNheSBvbiB0aGUgZmlyc3Qgc2xpZGU/XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VuZGVyOiBcIkphbmUgUG9ydGVyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogbmV3IERhdGUoMjAxNSwgMiwgMiwgOCwgMzEsIDAsIDApLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwiV2VsbCBpbmRlZWQsIEknbSBub3Qgc3VyZSBJIGdvdCB3aGF0IHRoZSBwcmVzZW50ZXIgc2FpZCBhYm91dCBwb2ludCAyLjIsIGNhbiB5b3UgaGVscCBtZT9cIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRpdGxlOiBcIlNlY29uZCBTbGlkZVwiLFxyXG4gICAgICAgICAgICBwaWN0dXJlOiBcImltZy9zbGlkZTIuanBnXCIsXHJcbiAgICAgICAgICAgIHRleHQ6IFtcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDFcIixcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDJcIixcclxuICAgICAgICAgICAgICAgIFwiICAgQnVsbGV0IFBvaW50IDIuMVwiLFxyXG4gICAgICAgICAgICAgICAgXCIgICBCdWxsZXQgUG9pbnQgMi4yXCIsXHJcbiAgICAgICAgICAgICAgICBcIkJ1bGxldCBQb2ludCAzXCIsXHJcbiAgICAgICAgICAgICAgICBcIiAgIEJ1bGxldCBQb2ludCAzLjFcIixcclxuICAgICAgICAgICAgICAgIFwiICAgQnVsbGV0IFBvaW50IDMuMlwiLFxyXG4gICAgICAgICAgICAgICAgXCIgICBCdWxsZXQgUG9pbnQgMy4zXCIsXHJcbiAgICAgICAgICAgICAgICBcIiAgIEJ1bGxldCBQb2ludCAzLjRcIixcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDRcIixcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDVcIixcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDZcIixcclxuICAgICAgICAgICAgICAgIFwiICAgQnVsbGV0IFBvaW50IDYuMVwiXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VuZGVyOiBcIkphbmUgUG9ydGVyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogbmV3IERhdGUoMjAxNSwgMiwgMiwgOCwgNDMsIDAsIDApLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwiV293LCB0aGlzIHNsaWRlIGlzIGp1c3QgaG9ycmlibGUsIHRoZXJlJ3MgdG9vIG11Y2ggaW5mb3JtYXRpb24gb24gaXQgSSBjYW4ndCBmaWd1cmUgb3V0IHdoYXQgSSBzaG91bGQgcmVhbGx5IHJlbWVtYmVyIG9uIHRoYXRcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzZW5kZXI6IFwiQ2hyaXMgSmFja1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKDIwMTUsIDIsIDIsIDgsIDQ2LCAwLCAwKSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBcIkkgZmVlbCB5b3VyIHBhaW4sIGJ1dCBmcm9tIHdoYXQgSSBnb3QgSSBmZWVsIGxpa2UgZXZlcnl0aGluZyBpcyBpbXBvcnRhbnQgb24gdGhlcmVcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzZW5kZXI6IFwiSm9obiBTbWl0aFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKDIwMTUsIDIsIDIsIDksIDExLCAwLCAwKSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBcIk9oIHJlYWxseSwgdGhlIG1vc3QgaW1wb3J0YW50IHBvaW50IGlzIHRoZSBzZWNvbmQgb25lLCB0aGUgcmVzdCBpcyBqdXN0IGRldGFpbC4gSSBhZ3JlZSB0aGUgcHJlc2VudGVyIHNob3VsZCBoYXZlIG1hZGUgaXQgY2xlYXJlciB0aG91Z2guXCJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aXRsZTogXCJUaGlyZCBTbGlkZVwiLFxyXG4gICAgICAgICAgICBwaWN0dXJlOiBcImltZy9zbGlkZTMuanBnXCIsXHJcbiAgICAgICAgICAgIHRleHQ6IFtcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDFcIixcclxuICAgICAgICAgICAgICAgIFwiICAgQnVsbGV0IFBvaW50IDEuMVwiLFxyXG4gICAgICAgICAgICAgICAgXCIgICBCdWxsZXQgUG9pbnQgMS4yXCIsXHJcbiAgICAgICAgICAgICAgICBcIiAgIEJ1bGxldCBQb2ludCAxLjNcIixcclxuICAgICAgICAgICAgICAgIFwiQnVsbGV0IFBvaW50IDJcIixcclxuICAgICAgICAgICAgICAgIFwiICAgQnVsbGV0IFBvaW50IDIuMVwiXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbXHJcblxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfVxyXG4gICAgXSxcclxuXHJcbiAgICBvblBvc3RNZXNzYWdlOiBmdW5jdGlvbihzbGlkZUlkLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgaWYobWVzc2FnZSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2xpZGVzW3NsaWRlSWRdLm1lc3NhZ2VzID0gdGhpcy5zbGlkZXNbc2xpZGVJZF0ubWVzc2FnZXMuY29uY2F0KHtcclxuICAgICAgICAgICAgICAgIHNlbmRlcjogXCJNZVwiLFxyXG4gICAgICAgICAgICAgICAgdGltZTogbmV3IERhdGUoRGF0ZS5ub3coKSksXHJcbiAgICAgICAgICAgICAgICBjb250ZW50OiBtZXNzYWdlXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKHRoaXMuc2xpZGVzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7QWN0aW9uczogQWN0aW9ucywgU3RvcmU6IFN0b3JlfTtcclxuIiwidmFyIFJlYWN0ID0gcmVxdWlyZSgncmVhY3QvYWRkb25zJyk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcclxuICAgIGdldERlZmF1bHRQcm9wczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY3VycmVudFNsaWRlOiAxXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgaWQgPSB0aGlzLnByb3BzLmN1cnJlbnRTbGlkZTtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0b3AtYmFyXCI+XHJcbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidXR0b24tZmlyc3RcIiBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2xpY2suYmluZChudWxsLCAxKX0+MTwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYnV0dG9uLWJhY2tcIiBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2xpY2suYmluZChudWxsLCBNYXRoLm1heCgxLCBpZCAtIDEpKX0gLz5cclxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ1dHRvbi1taWRkbGVcIj57dGhpcy5wcm9wcy5jdXJyZW50U2xpZGV9PC9idXR0b24+XHJcbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidXR0b24tbmV4dFwiIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGljay5iaW5kKG51bGwsIE1hdGgubWluKDMsIGlkICsgMSkpfS8+XHJcbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidXR0b24tbGFzdFwiIG9uQ2xpY2s9e3RoaXMucHJvcHMub25DbGljay5iaW5kKG51bGwsIDMpfT4zPC9idXR0b24+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59KTsiXX0=
